@model PMS.Models.Project
@{
    Layout = null;
}

<form id="createProjectForm" asp-action="Create" asp-controller="Projects" method="post">
    @Html.AntiForgeryToken()

    <div class="mb-3">
        <label asp-for="ProjectName" class="form-label"></label>
        <input asp-for="ProjectName" class="form-control" required />
        <span asp-validation-for="ProjectName" class="text-danger"></span>
    </div>

    <div class="mb-3">
        <label asp-for="Description" class="form-label"></label>
        <textarea asp-for="Description" class="form-control" required></textarea>
        <span asp-validation-for="Description" class="text-danger"></span>
    </div>

    <div class="row">
        <div class="col-md-6 mb-3">
            <label asp-for="Status"></label>
            <select asp-for="Status" class="form-control">
                <option>Planning</option>
                <option>Active</option>
                <option>Completed</option>
            </select>
        </div>
        <div class="col-md-6 mb-3">
            <label asp-for="Priority"></label>
            <select asp-for="Priority" class="form-control">
                <option>Low</option>
                <option>Medium</option>
                <option>High</option>
            </select>
        </div>
    </div>

    <div class="row">
        <div class="col-md-6 mb-3">
            <label asp-for="StartDate"></label>
            <input asp-for="StartDate" type="date" class="form-control" />
        </div>
        <div class="col-md-6 mb-3">
            <label asp-for="EndDate"></label>
            <input asp-for="EndDate" type="date" class="form-control" />
            <input type="hidden" asp-for="CreatedBy" value="@User.Identity?.Name ?? "Admin"" />
        </div>
    </div>

    <div class="mb-3">
        <label asp-for="ProjectColor"></label>
        <select asp-for="ProjectColor" class="form-control">
            <option>Blue</option>
            <option>Green</option>
            <option>Red</option>
            <option>Yellow</option>
        </select>
    </div>

    <button type="submit" class="btn btn-primary">Save Project</button>
</form>

<script>
   $("#createProjectForm").submit(function (e) {
    e.preventDefault();

    $.ajax({
        url: "/Projects/Create",
        type: "POST",
        data: $(this).serialize(),
        headers: {
            "RequestVerificationToken": $('input[name="__RequestVerificationToken"]').val()
        },
        success: function (response) {
            if (response.success) {
                $("#projectModal").modal("hide");
                location.reload();
            } else {
                alert("Error: " + response.errors.join(", "));
            }
        },
        error: function (xhr) {
            alert("Error: " + xhr.status + " " + xhr.statusText);
        }
    });
});
</script>


